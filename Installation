Nagios Installation and Configuration: (Source: https://visualpathdevopsmaterial.blogspot.com/2019/01/what-is-nagios-installation-and-configuration-of-nagios.html)

Nagios: Nagios is an open source and free computer-software application can be used to monitor systems, networks, and infrastructure. Nagios offers to monitor and alerting
services for servers, switches, applications, and services. It alerts users when things go wrong and alert them a second time after the problem has been resolved.

Network Monitoring: When it comes to open source network monitoring tools, the World’s largest organizations turn to Nagios. Nagios monitors the network for problems
caused by overloaded data links or network connections, as well as monitoring routers, switches and more. Easily able to monitor availability, uptime and response time
of every node on the network, Nagios can deliver the results in a variety of visual representations and reports.

Server Monitoring: Nagios is known for being the best server monitoring software on the market. Server monitoring is made easy in Nagios because of the flexibility to
monitor your servers with both agent-based and agentless monitoring. With over 5000 different add-ons available to monitor your servers, the community at the Nagios
Exchange have left no stone unturned.

Application Monitoring: Implementing effective application monitoring with Nagios allows your organization to quickly detect application, service, or process problems,
and take action to eliminate downtime for your application users. Nagios provides tools for monitoring of applications and application state – including
Windows applications, Linux applications, UNIX applications, and Web applications.

######## Nagios Core Installation - TESTED ######

>> Install the dependencies: Update your apt-get package lists:

    sudo apt-get update
    sudo apt-get install wget build-essential unzip openssl libssl-dev
    sudo apt-get install apache2 php libapache2-mod-php php-gd libgd-dev
    
>> NAGIOS SETUP: Create the Nagios user and group

    sudo adduser nagios
    sudo groupadd nagcmd
    sudo usermod -a -G nagcmd nagios
    sudo usermod -a -G nagcmd www-data

>> Install Nagios core: 

    cd /tmp   ## move to the home directory

>> Download the Nagios tar file from this URL:

    wget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.5.tar.gz (nagios-4.4.5)
               or 
    curl -L -O https://assets.nagios.com/downloads/nagioscore/releases/nagios-4.1.1.tar.gz (nagios-4.1.1)

>> Extract the Nagios archive with this command:

    tar xzf nagioscore.tar.gz
              or
    tar xvf nagios-*.tar.gz

>> Then change to the extracted directory:

    ls
    cd /tmp/nagioscore-nagios-4.4.5/

>> Before building Nagios, we must configure it:

    sudo ./configure --with-httpd-conf=/etc/apache2/sites-enabled
               or
    ./configure --with-nagios-group=nagios --with-command-group=nagcmd --with-mail=/usr/sbin/sendmail

>> Now compile Nagios with this command: (To build and install Nagios, init scripts, and sample configuration files)

    sudo make all
    sudo make install
    sudo make install-init
    sudo make install-commandmode
    sudo make install-config
    sudo make install-webconf
    
    sudo a2enmod rewrite
    sudo a2enmod cgi

    sudo ufw allow Apache
    sudo ufw reload
    
>> Nagios Userpassword Creation:

    sudo htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin
    
    sudo service apache2 restart
    sudo systemctl start nagios.service
    
    sudo apt-get install -y autoconf gcc libc6 libmcrypt-dev make libssl-dev wget bc gawk dc build-essential snmp libnet-snmp-perl gettext
    cd /tmp

>> Install the Nagios Plugins:

    wget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.2.1.tar.gz
    tar zxf nagios-plugins.tar.gz
    cd /tmp/nagios-plugins-release-2.2.1/

    sudo ./tools/setup
    sudo ./configure

    sudo make
    sudo make install

    sudo systemctl start nagios.service
    sudo systemctl restart nagios.service
    sudo systemctl status nagios.service

>>  On Node:

    sudo apt-get install nagios-nrpe-server nagios-plugins
    sudo nano /etc/nagios/nrpe.cfg
    sudo /etc/init.d/nagios-nrpe-server restart

>>  On Master:

    cd /usr/local/nagios/etc/objects
    ls
    sudo nano localhost.cfg

>>  copy the host configurations

    sudo nano host1.cfg
  
  define host {

    use                     linux-server
    host_name               nagios
    alias                   nagios-host
    address                 Private IP Address
}

    cd ..
    ls
    sudo nano nagios.cfg
    cfg_file=/usr/local/nagios/etc/objects/host1.cfg

    sudo systemctl restart nagios

>> Adding Service:

    cd /usr/local/nagios/etc/objects
    ls
    sudo nano templates.cfg
    sudo nano host1.cfg
    sudo systemctl restart nagios

  define service {

    name                            Http-service
    use                             generic-service
    host_name                       nagios
    service_description             HTTP
    check_command                   check_http
    check_interval                  1
    retry_interval                  1

}

#######################################################################################################################################################################


Prerequisites
To follow this tutorial, you must have superuser privileges on the Ubuntu 14.04 server that will run Nagios. Ideally, you will be using a non-root user with superuser
privileges.

LAMP Stack Script:

Nagios runs on LAMP stack which can be installed by below mentioned script.
$ cat lampstack.sh
apt-get update
apt-get install apache2 mysql-server php5-mysql vim php5 libapache2-mod-php5 php5-mcrypt
sudo mysql_install_db
sudo mysql_secure_installation
echo -e "<'IfModule mod_dir.c>\n DirectoryIndex index.php index.html index.cgi index.pl index.xhtml index.htm\n<'/IfModule>" > /etc/apache2/mods-enabled/dir.conf
service apache2 restart
apt-get install php5-cli
LAMP stack is also required.



  
  
  
==========================================================

########Nagios######
sudo apt-get update
sudo apt-get install wget build-essential unzip openssl libssl-dev
sudo apt-get install apache2 php libapache2-mod-php php-gd libgd-dev
sudo adduser nagios
sudo groupadd nagcmd
sudo usermod -a -G nagcmd nagios
sudo usermod -a -G nagcmd www-data
cd /tmp
wget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.5.tar.gz
ls
tar xzf nagioscore.tar.gz
cd /tmp/nagioscore-nagios-4.4.5/
sudo ./configure --with-httpd-conf=/etc/apache2/sites-enabled
sudo make all
sudo make install
sudo  make install-init
sudo make install-commandmode
sudo make install-config
sudo make install-webconf
sudo a2enmod rewrite
sudo a2enmod cgi
sudo ufw allow Apache
sudo ufw reload
sudo htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin
sudo service apache2 restart
sudo start nagios
sudo systemctl start nagios.service
sudo apt-get install -y autoconf gcc libc6 libmcrypt-dev make libssl-dev wget bc gawk dc build-essential snmp libnet-snmp-perl gettext
cd /tmp
wget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.2.1.tar.gz
tar zxf nagios-plugins.tar.gz
cd /tmp/nagios-plugins-release-2.2.1/
sudo ./tools/setup
sudo ./configure
sudo make
sudo make install
sudo systemctl start nagios.service
sudo systemctl restart nagios.service
sudo systemctl status nagios.service



on node:
sudo apt-get install nagios-nrpe-server nagios-plugins
sudo nano /etc/nagios/nrpe.cfg
sudo /etc/init.d/nagios-nrpe-server restart








On master
cd /usr/local/nagios/etc/objects
ls
sudo nano localhost.cfg
copy the host configurations
sudo nano host1.cfg
  define host {

    use                     linux-server
    host_name               nagios
    alias                   nagios-host
    address                 18.191.220.183
}
cd ..
ls
sudo nano nagios.cfg
  cfg_file=/usr/local/nagios/etc/objects/host1.cfg
sudo systemctl restart nagios



Adding service
cd /usr/local/nagios/etc/objects
ls
sudo nano templates.cfg
sudo nano host1.cfg
sudo systemctl restart nagios

  define service {

    name                            Http-service
    use                             generic-service
    host_name                       nagios
    service_description             HTTP
    check_command                   check_http
    check_interval                  1
    retry_interval                  1

}


